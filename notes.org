#+title: Notes
#+LANGUAGE: ru
#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS: [a4paper,fleqn,12pt]
#+LATEX_HEADER: \usepackage[lmargin=15mm, rmargin=15mm, tmargin=2cm, bmargin=2cm]{geometry}

* Постановка
Решить задачу \[
  \min \phi_{0}(x) \quad \forall x \in \Omega
\]
\[
  \Omega = \{x \in \RR ^{n} | \phi_{i} (x) \leq 0, i =\overline{1,m}\}
\]
методом отсекающей гиперплоскости.
Обосновать сходимость метода.
** Данные задачи:
В нашем случае \(\phi_{0} = x_1^2 + 4x_2^2 + \sin (6x_1 + 7x_2) + 3x_1 + 2x_2\) ---
нелинейная функция, значит вводим \(\phi_{4}(x_1,x_2,x_3) = \phi_{0} - x_3\), а в качестве
функции цели выберем \(\phi_{0}(x) = x_{3}\) Из решения задачи без ограничений знаем
точку минимума:
\[
  ([-1.9043886748215388, -0.36794672198200706], -3.2716974195454807)
\]
По условиям применимости метода \(\phi_{i}(x), i =\overline{1,m}\) должны быть
выпуклыми. Рассмотрим выпуклость функции \(\phi_{4}\)
\[
  \phi_{4}(x) = \phi_{41} + \phi_{42} - x_3
\]
\[
  \phi_{41} = x_1^2 + 4x_2^2 + 3x_1 + 2x_2 \text{ --- выпуклая }
\]
\[
  -x_3 \text{ --- линейная } \implies \text{ выпуклая}
\]
\[
  \phi_{42} = \sin (6x_1 + 7x_2)
\]
Для поиска интервала на котором функция \(\phi_{42}\) будет выпуклой, воспользуемся
теоремой:
#+begin_export latex
\begin{theorem}
  Пусть \(S\) --- непустое открытое выпуклое мн-во, \(\phi(x)\) --- дважды
  дифференцируемая функция. Тогда для того, чтобы \(\phi(x)\) была выпуклой
  функцией на \(S\) необходимо и достаточно, чтобы её гессиан \(H(x)\) был
  положительно-полуопределённой матрицей
\end{theorem}
#+end_export
\[
  H_{42}(x) = \begin{pmatrix}
                -36 \sin (6x_1 + 7x_2) & -42 \sin (6x_1 + 7x_2)\\
                -42 \sin (6x_1 + 7x_2) & -49 \sin (6x_1 + 7x_2)
              \end{pmatrix}
\]
Матрица будет положительно полуопределённой при \(\sin (6x_1 + 7x_2) \leq 0\).
(изначально исследование проводилось для всей функции, а не только для синуса,
но это не внесло значительных изменений (\(\sin (6x_1 + 7x_2) \leq 0.0414\)), хотя привело к существенному
удлинению выкладок)

Т.о. поставим линейные условия:
#+begin_export latex
\[
    \begin{split}
    6x_1 + 7x_2 \geq -5\pi\\
    6x_1 + 7x_2 \leq -4\pi
  \end{split}
\implies \begin{split}
    -6x_1 - 7x_2 -5\pi \leq 0\\
    6x_1 + 7x_2 +4\pi \leq 0
  \end{split}
\]
#+end_export
Поставим нелинейное условие:
\[
  (x+2)^2 + 3(y + 0.5)^2 \leq 0.5 \implies (x+2)^2 + 3(y+0.5)^2 - \frac{1}{2} \leq 0
\]

Так выглядит область допустимых значений при отображении через ~Desmos~
[[file:./figs/desmos.png]]

В качестве начального приближения возьмём многогранное мн-во \(S_0 = \{x|a_i^{T}x -
b_i \leq 0, i= -3,0\}\) где
#+begin_export latex
\[
  \begin{split}
    6x_1 + 7x_2 \leq -4\pi\\
    -6x_1 - 7x_2 \leq 5\pi\\
    x_2 \leq -0.05\\
    x_2 + 0.5 \geq x_1\\
    -x_1-x_2+x_3 \geq -2\\
    x_3 \leq  50\\
  \end{split} \implies \begin{split}
              6x_1 + 7x_2 \leq  -4\pi\\
              -6x_1 - 7x_2 \leq 5\pi\\
              x_2 \leq -0.05\\
              x_1 - x_2 \leq 0.5\\
              x_1+x_2-x_3 \leq 2\\
              x_3 \leq 50
            \end{split}
\]
Представление исходного полиэдра в виде матрицы ограничений
#+end_export
#+begin_src csv :comments no :tangle build/task.csv
6,3
0,0,1
6,7,0,LT,-12.566
-6,-7,0,LT,15.708
0,1,0,LT,-0.05
1,-1,0,LT,0.5
1,1,-1,LT,2
0,0,1,LT,50
1,2,3
#+end_src
**  О субградиенте
#+begin_export latex
\begin{definition}
  Вектор \(y \in \RR ^{n}\) называется субградиентом функции \(\phi(x)\) в точке
  \(x_0 \in S\), если \[
\phi(x) \geq \phi(x_0) + y^{T}(x-x_0), \quad \forall x \in S
  \]
  Заметим, что \(y = y(x_0)\)\\
\end{definition}
#+end_export
В прошлом семестре была доказана теорема:\\
#+begin_export latex
\begin{theorem}
  Пусть \(\phi(x)\) --- выпукло-дифференцируемая функция, заданная на выпуклом
  множестве \(S\), причём \(\dot{S} \neq \emptyset\). Тогда в каждой точке
  \(x_0 \in \dot{S}\) субградиент \(y = \nabla \phi(x_0)\)
\end{theorem}
#+end_export

Рассмотрим функцию \(\phi(x) = \max_{i} \{\phi_{i}(x)\}\). Запишем субградиент функции
\(\phi_{i}(x)\)
\[
  \phi_{i}(x) \geq \phi_{i}(x_0) + y_{i}^{T}(x - x_0)
\]
По теореме, \(y_{i} = \nabla \phi_{i}(x_0)\). Будем использовать \(\phi_{i} : \phi(x_{0}) = \phi_{i}(x_0)\)
(наибольшую из функций в заданной точке). Тогда
\[
  \phi(x) \geq \phi_{i}(x) \geq \phi_{i}(x_0) + \nabla \phi_{i}^{T}(x - x_0) = \phi(x_0) + \nabla \phi_{i}^{T}(x - x_0)
\]
Таким образом, \(\nabla \phi_{i}(x_0)\) --- субградиент функции \(\phi\) в т. \(x_0\)
* Условие оптимальности

В общем случае необходимым условием условного экстремума является равенство нулю
градиента функции Лагранжа:
\[
  L(x,\lambda) = \phi_{0}(x) + \sum_{i=1}^n \lambda_{i}\phi_{i}(x)
\]
Где \(\phi_{i}(x), i = \overline{1,n}\) --- функции, задающие уравнения связи
\(\phi_{i}=0\). Функция \(L\) является функцией не только \(x\), но и \(\lambda\), поэтому
для того, чтобы проверить условие на градиент, нужно получить \(\lambda\). Однако
исследуемый метод не находит \(\lambda\), что означает, что мы не можем использовать
это условие.

Функция Лагранжа для нашей задачи:
#+begin_export latex
\[
  \begin{split}
    L(x,y) &= x_1^2 + 4x_2^2 + \sin (6x_1 + 7x_2) + 3x_1 + 2x_2 +
    &y_1\left((x_1 + 2)^2 + 3(y + 0.5)^2 - \frac{1}{2} \right) +\\
    &+ y_2(-6x_1 - 7x_2 -5\pi) + y_3(6x_1 + 7x_2 + 4\pi)&
  \end{split}
\]
#+end_export

Не знаю надо ли писать список с учётом последнего параграфа.

1. \(\nabla L(x,y) = 0\)
   #+begin_export latex
   \[
   \begin{cases}
     2x_1 + 6 \cos (6x_1 + 7x_2) + 3 + 2y_1(x_1+2) - 6y_2 + 6y_3\\
     8x_2 + 7\cos (6x_1 + 7x_2) + 2 + 6y_1(x_2 + 0.5) -7y_2 + 7y_3
   \end{cases}
   \]
   #+end_export
2. Условия дополняющей нежесткости:
   #+begin_export latex
   \[
     \begin{cases}
       y_1\left((x_1 + 2)^2 + 3(y + 0.5)^2 - \frac{1}{2} \right) = 0\\
       y_2(-6x_1 - 7x_2 -5\pi) = 0\\
       y_3(6x_1 + 7x_2 + 4\pi)
     \end{cases}
   \]
   #+end_export
3. Ограничение на знак:
   #+begin_export latex
     \[
   \begin{cases}
   y_1 \geq 0\\
   y_2 \geq 0\\
   y_3 \geq 0
   \end{cases}
 \]
 #+end_export

Точка экстремума находится внутри множества, поэтому все ограничения выполняются
пассивно и \(y = 0\) . Таким образом, градиент функции Лагранжа равен градиенту
функции \(\phi_{0}\).

При \(\epsilon = 10^{-3}\), \(\norm{x- x_{*}} = 10^{-3}, \norm{\nabla \phi_{0}(x)} = 4\cdot 10^{-3}\)
